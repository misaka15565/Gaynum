<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>名字Gay指数计算器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .rainbow-text {
            background: linear-gradient(90deg, #ef4444, #f97316, #eab308, #84cc16, #22c55e, #14b8a6, #06b6d4, #3b82f6, #8b5cf6, #d946ef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }

        .progress-bar-inner {
            transition: width 0.8s cubic-bezier(0.25, 0.1, 0.25, 1), background-color 0.8s ease;
        }

        /* -- 新增和修改的动画 -- */
        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-6px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(6px);
            }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        @keyframes rainbow-glow {

            0%,
            100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .rainbow-100 {
            background: linear-gradient(270deg, #d946ef, #8b5cf6, #3b82f6, #06b6d4, #14b8a6, #22c55e, #84cc16, #eab308, #f97316, #ef4444);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: rainbow-glow 2s linear infinite;
        }

        /* 1. 页面加载时主容器的进入动画 */
        @keyframes initial-fade-in {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .container-fade-in {
            animation: initial-fade-in 0.7s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
        }

        /* 2. 结果百分比的“砰”弹出动画 */
        @keyframes pop-in {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }

            70% {
                transform: scale(1.1);
                opacity: 1;
            }

            100% {
                transform: scale(1);
            }
        }

        .pop-in {
            animation: pop-in 0.5s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
        }

        /* 3. 进度条的辉光动画 */
        @keyframes pulse-glow {

            0%,
            100% {
                box-shadow: 0 0 8px rgba(168, 85, 247, 0.3), 0 0 12px rgba(168, 85, 247, 0.2);
            }

            50% {
                box-shadow: 0 0 16px rgba(168, 85, 247, 0.7), 0 0 24px rgba(168, 85, 247, 0.5);
            }
        }

        .pulsing-glow {
            animation: pulse-glow 1.5s infinite ease-in-out;
        }
    </style>
</head>

<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">
    <!-- 增加了 container-fade-in class 来实现进入动画 -->
    <div class="w-full max-w-md mx-auto bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 space-y-6 container-fade-in">
        <!-- Header -->
        <div class="text-center">
            <h1 class="text-3xl font-bold rainbow-text">名字Gay指数计算器</h1>
            <p class="text-gray-400 mt-2">输入一个名字，看看“科学”的计算结果！</p>
            <p class="text-xs text-gray-500 mt-1">（纯属娱乐，请勿当真）</p>
        </div>

        <!-- Input Form -->
        <div class="space-y-4">
            <input type="text" id="nameInput" placeholder="输入任何名字或网名"
                class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300">
            <!-- 增加了 active:scale-95 来实现按钮按压效果 -->
            <button id="calculateBtn"
                class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-105 active:scale-95 shadow-lg">
                <span id="btnText">开始计算</span>
                <span id="btnSpinner" class="hidden animate-spin">◐</span>
            </button>
        </div>

        <!-- Result Section -->
        <div id="resultSection" class="hidden pt-6 space-y-4 text-center">
            <h2 class="text-xl font-semibold text-gray-300 fade-in-up">计算结果 for "<span id="resultName"
                    class="font-bold text-purple-400"></span>"</h2>

            <div class="relative w-full h-8 bg-gray-700 rounded-full overflow-hidden border-2 border-gray-600">
                <div id="progressBar" class="progress-bar-inner h-full rounded-full" style="width: 0%;"></div>
                <span id="percentageText"
                    class="absolute inset-0 flex items-center justify-center text-sm font-bold text-white opacity-0">0%</span>
            </div>

            <p id="resultMessage" class="text-lg font-medium text-gray-200 h-12 flex items-center justify-center"></p>
        </div>
    </div>

    <script>
        window.onload = function () {
            const nameInput = document.getElementById('nameInput');
            const calculateBtn = document.getElementById('calculateBtn');
            const btnText = document.getElementById('btnText');
            const btnSpinner = document.getElementById('btnSpinner');

            const resultSection = document.getElementById('resultSection');
            const resultName = document.getElementById('resultName');
            const progressBar = document.getElementById('progressBar');
            const percentageText = document.getElementById('percentageText');
            const resultMessage = document.getElementById('resultMessage');

            let typingInterval; // 用于控制打字机效果的计时器

            function longhexmod101(hexstr) {
                const MOD = 101;
                let result = 0;

                for (let i = 0; i < hexstr.length; i++) {
                    const char = hexstr[i];
                    const value = parseInt(char, 16);
                    result = (result * 16 + value) % MOD;
                }
                return result;
            }

            function calgay(name, salt) {
                //计算name+salt的sha256
                const hash = CryptoJS.SHA256(name + salt).toString();
                const t = longhexmod101(hash);
                if (salt === 1) {
                    console.log(`name:${name}, salt:${salt}, hash:${hash} , result:${t}`);
                }
                return t;
            }

            function getResultMessage(percentage) {
                const messageTiers = {
                    0: ["0%... 你是直尺成精了吗？", "零！你的世界里连彩虹都是黑白的吗？", "成分过纯，建议去钢铁厂上班。", "比我的银行余额还直，令人敬畏。", "检测不到任何弯的迹象，程序可能出错了。"],
                    10: ["钢铁直男/女，宇宙都掰不弯你。", "你走过的路，比笔还直。", "身上充满了‘直’气，妖魔鬼怪都得退散。", "别说弯了，你连转个弯都费劲。", "堪称异性恋的最后一道防线。"],
                    20: ["直得有点刻意了，是不是在伪装？", "指数这么低，是不是对同性有什么误解？", "你大概是那种‘啊？他俩是gay？’的迟钝类型。", "你的世界简单得像一条直线。", "朋友，恐同即深柜，再测测？"],
                    40: ["内心可能有点小波动，但无伤大雅。", "偶尔会觉得‘同性也挺可爱的嘛’的程度。", "雷达偶尔会收到微弱信号，但很快就忽略了。", "在弯的边缘试探，但又缩回了脚。", "一只脚还在柜外，另一只脚在门槛上摩擦。"],
                    60: ["有点意思，雷达的指针动了一下。", "已经开始对一些特定类型的同性产生欣赏了。", "你离出柜，就差一个契机。", "嘴上说着不要，身体却很诚实。", "是时候更新一下你的交友软件筛选器了。"],
                    75: ["别装了，你的品味出卖了你！", "Gay达已经开始报警，只是声音比较小。", "你怕不是通讯录里的常驻嘉宾？", "说吧，你的理想型是体育生还是艺术生？", "看到帅哥/美女会心跳加速，不分性别。"],
                    90: ["衣柜门都快关不住了吧！", "姬达/Gay达信号强度已爆表！", "下一步是不是就要统治通讯录了？", "你弯得像盘蚊香，还带电的那种。", "别点了，自己人，快开门！"],
                    100: ["警报！已无需鉴定，天生的弯！", "你就是彩虹本虹！", "恭喜！你已解锁‘通讯录天花板’成就！", "弯得彻底，连影子都是弯的。", "出厂设置就是弯的，别挣扎了。"]
                };
                let selectedTier;
                if (percentage === 0) selectedTier = messageTiers[0];
                else if (percentage <= 10) selectedTier = messageTiers[10];
                else if (percentage <= 20) selectedTier = messageTiers[20];
                else if (percentage <= 40) selectedTier = messageTiers[40];
                else if (percentage <= 60) selectedTier = messageTiers[60];
                else if (percentage <= 75) selectedTier = messageTiers[75];
                else if (percentage <= 90) selectedTier = messageTiers[90];
                else selectedTier = messageTiers[100];
                const randomIndex = Math.floor(Math.random() * selectedTier.length);
                return selectedTier[randomIndex];
            }

            function getProgressBarColor(percentage) {
                const colors = [{ p: 0, color: '#3b82f6' }, { p: 25, color: '#22c55e' }, { p: 50, color: '#eab308' }, { p: 75, color: '#f97316' }, { p: 100, color: '#d946ef' }];
                for (let i = 1; i < colors.length; i++) {
                    if (percentage <= colors[i].p) {
                        const p1 = colors[i - 1].p, p2 = colors[i].p, c1 = colors[i - 1].color, c2 = colors[i].color;
                        const factor = (p2 - p1 === 0) ? 1 : (percentage - p1) / (p2 - p1);
                        const r1 = parseInt(c1.substring(1, 3), 16), g1 = parseInt(c1.substring(3, 5), 16), b1 = parseInt(c1.substring(5, 7), 16);
                        const r2 = parseInt(c2.substring(1, 3), 16), g2 = parseInt(c2.substring(3, 5), 16), b2 = parseInt(c2.substring(5, 7), 16);
                        const r = Math.round(r1 + factor * (r2 - r1)), g = Math.round(g1 + factor * (g2 - g1)), b = Math.round(b1 + factor * (b2 - b1));
                        return `rgb(${r},${g},${b})`;
                    }
                }
                return colors[colors.length - 1].color;
            }

            // 4. 新增的打字机效果函数
            function typeResultMessage(message) {
                clearInterval(typingInterval);
                resultMessage.textContent = '';
                let i = 0;
                typingInterval = setInterval(() => {
                    if (i < message.length) {
                        resultMessage.textContent += message.charAt(i);
                        i++;
                    } else {
                        clearInterval(typingInterval);
                    }
                }, 50); // 每个字 50 毫秒
            }

            function displayResult(name, percentage) {
                resultName.textContent = name;
                resultSection.classList.remove('hidden');

                // 重置样式
                percentageText.style.opacity = 0;
                resultMessage.textContent = '';
                percentageText.classList.remove('pop-in', 'rainbow-100');
                progressBar.classList.remove('pulsing-glow');

                setTimeout(() => progressBar.classList.add('pulsing-glow'), 100);

                let currentPercent = -1;
                const interval = setInterval(() => {
                    currentPercent++;
                    if (currentPercent >= percentage) {
                        clearInterval(interval);
                        currentPercent = percentage;

                        percentageText.textContent = `${currentPercent}%`;
                        percentageText.style.opacity = 1;
                        percentageText.classList.add('pop-in'); // 应用弹出动画

                        const finalMessage = getResultMessage(percentage);
                        typeResultMessage(finalMessage); // 调用打字机效果

                        if (currentPercent === 100) {
                            percentageText.classList.add('rainbow-100');
                        }

                        setTimeout(() => progressBar.classList.remove('pulsing-glow'), 500);
                    }
                    progressBar.style.width = `${currentPercent}%`;
                    progressBar.style.backgroundColor = getProgressBarColor(currentPercent);
                    if (currentPercent !== -1) {
                        percentageText.textContent = `${currentPercent}%`;
                        percentageText.style.opacity = 1;
                    }
                }, 20);
            }

            function handleCalculation() {
                const originalName = nameInput.value;
                if (!originalName.trim()) {
                    nameInput.classList.add('shake');
                    setTimeout(() => nameInput.classList.remove('shake'), 500);
                    return;
                }
                btnText.classList.add('hidden');
                btnSpinner.classList.remove('hidden');
                calculateBtn.disabled = true;
                resultSection.classList.add('hidden');

                clearInterval(typingInterval); // 如果上次的打字机还在运行，则清除

                setTimeout(() => {
                    salt = "@15%Hk,(";
                    
                    //将名字转小写并去空格和中间的空格
                    nameforCal = originalName.toLowerCase().trim().replace(/\s+/g, '');

                    const finalPercentage = calgay(nameforCal, salt);
                    displayResult(originalName, finalPercentage);
                    btnText.classList.remove('hidden');
                    btnSpinner.classList.add('hidden');
                    calculateBtn.disabled = false;
                }, 800);
            }

            calculateBtn.addEventListener('click', handleCalculation);
            nameInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    handleCalculation();
                }
            });
        };
    </script>
</body>

</html>